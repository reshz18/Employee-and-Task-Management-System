<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <title>Your Tasks</title>
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        padding: 40px 0;
      }
      
      .task-container {
        background-color: rgba(255, 255, 255, 0.9);
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        padding: 30px;
        position: relative;
        overflow: hidden;
      }
      
      .task-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 10px;
        background: linear-gradient(90deg, #4776E6 0%, #8E54E9 100%);
      }
      
      h1 {
        color: #444;
        font-weight: 700;
        margin-bottom: 30px;
        position: relative;
        display: inline-block;
      }
      
      h1::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 50%;
        height: 4px;
        background: linear-gradient(90deg, #4776E6 0%, #8E54E9 100%);
        border-radius: 2px;
      }
      
      .back-btn {
        margin-bottom: 25px;
        border-radius: 50px;
        padding: 10px 20px;
        font-weight: 500;
        border: none;
        background: linear-gradient(90deg, #4776E6 0%, #8E54E9 100%);
        box-shadow: 0 4px 15px rgba(71, 118, 230, 0.3);
        transition: all 0.3s ease;
      }
      
      .back-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(71, 118, 230, 0.4);
        background: linear-gradient(90deg, #3d68cc 0%, #7b48cc 100%);
      }
      
      .back-btn i {
        margin-right: 8px;
      }
      
      .task-table {
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }
      
      .task-table thead {
        background: linear-gradient(90deg, #4776E6 0%, #8E54E9 100%);
        color: white;
      }
      
      .task-table th {
        font-weight: 600;
        padding: 15px;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 0.5px;
      }
      
      .task-table tbody tr {
        transition: all 0.3s ease;
      }
      
      .task-table tbody tr:hover {
        background-color: rgba(142, 84, 233, 0.05);
        transform: scale(1.01);
      }
      
      .task-table td {
        padding: 15px;
        vertical-align: middle;
      }
      
      .priority-badge {
        padding: 6px 12px;
        border-radius: 50px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .priority-high {
        background-color: rgba(255, 92, 92, 0.15);
        color: #ff5c5c;
      }
      
      .priority-medium {
        background-color: rgba(255, 187, 92, 0.15);
        color: #ffbb5c;
      }
      
      .priority-low {
        background-color: rgba(76, 217, 100, 0.15);
        color: #4cd964;
      }
      
      .status-select {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 50px;
        padding: 10px 15px;
        width: 100%;
        font-size: 0.85rem;
        color: #495057;
        transition: all 0.3s ease;
      }
      
      .status-select:focus {
        border-color: #8E54E9;
        box-shadow: 0 0 0 0.2rem rgba(142, 84, 233, 0.25);
        outline: 0;
      }
      
      .file-upload {
        position: relative;
        overflow: hidden;
        display: inline-block;
        width: 100%;
      }
      
      .file-upload-label {
        display: block;
        background-color: #f8f9fa;
        border: 1px dashed #ced4da;
        border-radius: 10px;
        padding: 10px;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      
      .file-upload-label:hover {
        background-color: #e9ecef;
        border-color: #adb5bd;
      }
      
      .file-upload input[type="file"] {
        position: absolute;
        left: 0;
        top: 0;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
      }
      
      .file-upload-label i {
        display: block;
        font-size: 1.5rem;
        color: #8E54E9;
        margin-bottom: 5px;
      }
      
      .btn-task {
        border-radius: 50px;
        padding: 8px 20px;
        font-weight: 500;
        font-size: 0.85rem;
        letter-spacing: 0.5px;
        text-transform: uppercase;
        transition: all 0.3s ease;
        margin: 3px;
      }
      
      .btn-save {
        background-color: #f8f9fa;
        color: #495057;
        border: 1px solid #e9ecef;
      }
      
      .btn-save:hover {
        background-color: #e9ecef;
        color: #212529;
      }
      
      .btn-submit {
        background: linear-gradient(90deg, #4cd964 0%, #5ac8fa 100%);
        border: none;
        color: white;
        box-shadow: 0 4px 15px rgba(76, 217, 100, 0.3);
      }
      
      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(76, 217, 100, 0.4);
        background: linear-gradient(90deg, #3ebe51 0%, #48b0df 100%);
        color: white;
      }
      
      .task-description {
        font-size: 0.9rem;
        color: #6c757d;
        max-width: 250px;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
      }
      
      .task-name {
        font-weight: 600;
        color: #343a40;
      }
      
      .empty-state {
        padding: 50px 0;
        text-align: center;
        color: #adb5bd;
      }
      
      .empty-state i {
        font-size: 5rem;
        margin-bottom: 20px;
        opacity: 0.3;
      }
      
      .empty-state p {
        font-size: 1.1rem;
        font-weight: 500;
      }
      
      @media (max-width: 992px) {
        .task-table {
          display: block;
          overflow-x: auto;
          white-space: nowrap;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="task-container">
        <h1>Your Tasks</h1>
        <a class="btn back-btn" href="{% url 'employee_dashboard' %}">
          <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
        
        <div class="task-table">
          {% if tasks %}
          <table class="table table-hover">
            <thead>
              <tr>
                <th><i class="fas fa-hashtag me-2"></i>ID</th>
                <th><i class="fas fa-tasks me-2"></i>Task Name</th>
                <th><i class="fas fa-info-circle me-2"></i>Description</th>
                <th><i class="fas fa-flag me-2"></i>Priority</th>
                <th><i class="fas fa-chart-line me-2"></i>Status</th>
                <th><i class="fas fa-paperclip me-2"></i>Attachment</th>
                <th><i class="fas fa-cogs me-2"></i>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for task in tasks %}
              <tr>
                <td>{{ task.id }}</td>
                <td class="task-name">{{ task.task_name }}</td>
                <td>
                  <div class="task-description" title="{{ task.task_description }}">
                    {{ task.task_description }}
                  </div>
                </td>
                <td>
                  {% if task.task_priority == "High" %}
                  <span class="priority-badge priority-high">
                    <i class="fas fa-exclamation-circle me-1"></i>High
                  </span>
                  {% elif task.task_priority == "Medium" %}
                  <span class="priority-badge priority-medium">
                    <i class="fas fa-exclamation-triangle me-1"></i>Medium
                  </span>
                  {% else %}
                  <span class="priority-badge priority-low">
                    <i class="fas fa-check-circle me-1"></i>Low
                  </span>
                  {% endif %}
                </td>
                <td>
                  <form method="POST" enctype="multipart/form-data" action="{% url 'update_task' task.id %}">
                    {% csrf_token %}
                    <select name="task_status" class="status-select">
                      <option value="Not Started" {% if task.employee_task.task_status == "Not Started" %}selected{% endif %}>
                        <i class="fas fa-hourglass-start"></i> Not Started
                      </option>
                      <option value="In Progress" {% if task.employee_task.task_status == "In Progress" %}selected{% endif %}>
                        <i class="fas fa-spinner"></i> In Progress
                      </option>
                      <option value="Completed" {% if task.employee_task.task_status == "Completed" %}selected{% endif %}>
                        <i class="fas fa-check"></i> Completed
                      </option>
                    </select>
                </td>
                <td>
                  <div class="file-upload">
                    <label class="file-upload-label">
                      <i class="fas fa-cloud-upload-alt"></i>
                      <span>Choose file</span>
                      <input type="file" name="file">
                    </label>
                  </div>
                </td>
                <td>
                  <button type="submit" name="save" class="btn btn-task btn-save">
                    <i class="fas fa-save me-1"></i> Save
                  </button>
                  <button type="submit" name="submit" class="btn btn-task btn-submit">
                    <i class="fas fa-paper-plane me-1"></i> Submit
                  </button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <div class="empty-state">
            <i class="fas fa-tasks"></i>
            <p>No tasks assigned yet.</p>
            <small>Check back later or contact your supervisor.</small>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      // Update file input label with filename when file is selected
      document.querySelectorAll('input[type="file"]').forEach(input => {
        input.addEventListener('change', (e) => {
          const label = e.target.previousElementSibling;
          const labelText = label.querySelector('span');
          if (e.target.files.length > 0) {
            labelText.textContent = e.target.files[0].name;
          } else {
            labelText.textContent = 'Choose file';
          }
        });
      });
      
      // Add visual feedback for form submission
      document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', (e) => {
          const button = e.submitter;
          button.disabled = true;
          button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        });
      });
    </script>
  </body>
</html>